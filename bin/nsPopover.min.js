/**
 * nsPopover - v0.6.8 - 2017-01-09
 * http://nohros.com/nsPopover
 *
 * Copyright (c) 2017 Neylor Ohmaly
 * Licensed MIT <https://raw.github.com/nohros/nsPopover/master/LICENSE>
 */
!function(a,b,c){"use strict";var d=b.element,e=0,f=b.isDefined,g=b.module("nsPopover",[]);g.provider("nsPopover",function(){var a={angularEvent:null,container:"body",hideOnButtonClick:!0,hideOnInsideClick:!1,hideOnOutsideClick:!0,mouseRelative:"",onClose:b.noop,onOpen:b.noop,placement:"bottom|left",plain:"false",popupDelay:0,restrictBounds:!1,scopeEvent:null,template:"",theme:"ns-popover-list-theme",timeout:1.5,trigger:"click",triggerPrevent:!0};this.setDefaults=function(c){b.extend(a,c)},this.$get=function(){return{getDefaults:function(){return a}}}}),g.directive("nsPopover",["nsPopover","$rootScope","$timeout","$templateCache","$q","$http","$compile","$document","$parse",function(g,h,i,j,k,l,m,n,o){return{restrict:"A",scope:!0,link:function(p,q,r){function s(){function a(){I.cancel()}function b(){I.hide(O.timeout)}q.on("mouseout",b).on("mouseover",a),E.on("mouseout",b).on("mouseover",a),L=function(){q.off("mouseout",b).off("mouseover",a),E.off("mouseout",b).off("mouseover",a)}}function t(a,b,c,d){var e={bottom:a.bottom,height:a.height,left:a.left,right:a.right,top:a.top,width:a.width};return b&&(e.left=d.pageX,e.right=d.pageX,e.width=0),c&&(e.top=d.pageY,e.bottom=d.pageY,e.height=0),e}function u(){E.isOpen&&p.hidePopover()}function v(a){b.isObject(a)&&!1!==O.triggerPrevent&&a.preventDefault(),I.cancel(),H.display(O.popupDelay,a)}function w(b){var c=a,d=document.documentElement||document.body.parentNode||document.body,e=f(c.pageXOffset)?c.pageXOffset:d.scrollLeft,g=f(c.pageYOffset)?c.pageYOffset:d.scrollTop,h=b.getBoundingClientRect();return e||g?{bottom:h.bottom+g,left:h.left+e,right:h.right+e,top:h.top+g,height:h.height,width:h.width}:h}function x(){E.isOpen&&p.hidePopover()}function y(a,c){return a?b.isString(a)&&c?a:j.get(a)||l.get(a,{cache:!0}):""}function z(a,b,c,d,e){var f,g,h,i,j=w(a[0]),k=function(){return"center"===c?Math.round(d.left+d.width/2-j.width/2):"right"===c?d.right-j.width:d.left},l=function(){return"center"===c?Math.round(d.top+d.height/2-j.height/2):"bottom"===c?d.bottom-j.height:d.top};"top"===b?(h=d.top-j.height,i=k()):"right"===b?(h=l(),i=d.right):"bottom"===b?(h=d.bottom,i=k()):"left"===b&&(h=l(),i=d.left-j.width),!0===O.restrictBounds&&(f=w(D[0]),i=Math.max(f.left,i),g=i+j.width,g>f.width&&(i-=g-f.width)),a.css("top",h.toString()+"px").css("left",i.toString()+"px"),e&&e.length&&("top"===b||"bottom"===b?(i=d.left+d.width/2-i,e.css("left",i.toString()+"px")):(h=d.top+d.height/2-h,e.css("top",h.toString()+"px")))}function A(a){function c(a){if(a.id===d)return!0;var e=b.element(a).parent()[0];return e?e.id===d?!0:c(e):!1}if(E.isOpen&&a.target!==q[0]){var d=E[0].id;c(a.target)||p.hidePopover()}}function B(){L()}function C(a){if(a&&0!==a.length){var b=(""+a).toLowerCase();a="true"==b}else a=!1;return a}var D,E,F,G,H,I,J,K,L,M,N=g.getDefaults(),O={angularEvent:r.nsPopoverAngularEvent||N.angularEvent,container:r.nsPopoverContainer||N.container,group:r.nsPopoverGroup,hideOnButtonClick:C(r.nsPopoverHideOnButtonClick||N.hideOnButtonClick),hideOnInsideClick:C(r.nsPopoverHideOnInsideClick||N.hideOnInsideClick),hideOnOutsideClick:C(r.nsPopoverHideOnOutsideClick||N.hideOnOutsideClick),mouseRelative:r.nsPopoverMouseRelative,onClose:o(r.nsPopoverOnClose)||N.onClose,onOpen:o(r.nsPopoverOnOpen)||N.onOpen,placement:r.nsPopoverPlacement||N.placement,plain:C(r.nsPopoverPlain||N.plain),popupDelay:r.nsPopoverPopupDelay||N.popupDelay,restrictBounds:Boolean(r.nsPopoverRestrictBounds)||N.restrictBounds,scopeEvent:r.nsPopoverScopeEvent||N.scopeEvent,template:r.nsPopoverTemplate||N.template,theme:r.nsPopoverTheme||N.theme,timeout:r.nsPopoverTimeout||N.timeout,trigger:r.nsPopoverTrigger||N.trigger,triggerPrevent:r.nsPopoverTriggerPrevent||N.triggerPrevent};if(O.mouseRelative&&(O.mouseRelativeX=-1!==O.mouseRelative.indexOf("x"),O.mouseRelativeY=-1!==O.mouseRelative.indexOf("y")),H={id_:c,display:function(a,c){o(r.nsPopover)(p)!==!1&&(k.when(y(O.template,O.plain)).then(function(a){b.isObject(a)&&(a=b.isString(a.data)?a.data:""),E.html(a),O.theme&&E.addClass(O.theme),m(E)(p),F=d(E[0].querySelectorAll(".triangle")),D.append(E)}),i.cancel(H.id_),f(a)||(a=0),O.group&&h.$broadcast("ns:popover:hide",O.group),H.id_=i(function(){if(!0!==E.isOpen){E.isOpen=!0,E.css("display","block");var a=w(q[0]);O.mouseRelative&&(a=t(a,O.mouseRelativeX,O.mouseRelativeY,c)),z(E,K,G,a,F),s(),!0===O.hideOnInsideClick&&E.on("click",x),!0===O.hideOnOutsideClick&&n.on("click",A),!0===O.hideOnButtonClick&&q.on("click",u),O.onOpen(p)}},1e3*a))},cancel:function(){i.cancel(H.id_)}},I={id_:c,hide:function(a){i.cancel(I.id_),"-1"!==a&&(f(a)||(a=1.5),I.id_=i(function(){E.off("click",x),n.off("click",A),q.off("click",u),E.isOpen=!1,H.cancel(),E.css("display","none"),B(),O.onClose(p)},1e3*a))},cancel:function(){i.cancel(I.id_)}},D=n.find(O.container),D.length||(D=n.find("body")),J=O.placement.match(/^(top|bottom|left|right)$|((top|bottom)\|(center|left|right)+)|((left|right)\|(center|top|bottom)+)/),!J)throw new Error('"'+O.placement+'" is not a valid placement or has an invalid combination of placements.');K=J[6]||J[3]||J[1],G=J[7]||J[4]||J[2]||"center",e+=1,E=d('<div id="nspopover-'+e+'"></div>').addClass("ns-popover-"+K+"-placement").addClass("ns-popover-"+G+"-align").css("position","absolute").css("display","none"),p.hidePopover=function(){I.hide(0)},p.$on("ns:popover:hide",function(a,b){O.group===b&&p.hidePopover()}),p.$on("$destroy",function(){E.remove(),M()}),b.isString(O.angularEvent)?M=h.$on(O.angularEvent,v):b.isString(O.scopeEvent)?M=p.$on(O.scopeEvent,v):(q.on(O.trigger,v),M=function(){q.off(O.trigger,v)})}}}])}(window,window.angular);